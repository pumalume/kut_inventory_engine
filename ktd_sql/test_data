-- 1. STAFF / CHEFS (Metadata for AI Tracking)
-- We will use the ai_context in production logs to track these names.
-- Names: Serkan (Master Chef), Fatma (Pastry Lead), Emre (Ice Cream Specialist)

-- 2. BULK INVENTORY ARRIVAL (Oct 1, 2025)
INSERT INTO ktd_ingredients (ingredient_name, unit_id, reorder_level, current_cost) VALUES 
('Antep FÄ±stÄ±ÄŸÄ± (Extra)', 1, 50.0, 1100.00), -- High cost for Baklava/Ice Cream
('Kristal Åžeker', 1, 200.0, 28.50),
('BaklavalÄ±k Un', 1, 300.0, 22.00),
('Tam YaÄŸlÄ± SÃ¼t', 2, 500.0, 32.00),
('AyÃ§iÃ§ek YaÄŸÄ±', 2, 100.0, 45.00), -- For Tulumba frying
('Salep (Pure)', 1, 5.0, 2500.00); -- The expensive "secret" for Dondurma

-- 3. INITIAL STOCK LEDGER ENTRIES
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 1, 250.0, 'PURCHASE', 'Initial seasonal bulk buy - Supplier: Gaziantep Birlik'),
(1, 2, 1000.0, 'PURCHASE', 'Initial seasonal bulk buy'),
(1, 3, 1500.0, 'PURCHASE', 'Initial seasonal bulk buy'),
(1, 4, 2000.0, 'PURCHASE', 'Contracted delivery - Local Farm'),
(1, 5, 300.0, 'PURCHASE', 'Bulk oil delivery for Tulumba station');

-- CHUNK 2: OCTOBER PRODUCTION & RETAIL SALES (OCT 1 - OCT 15)

-- 1. PRODUCTION LOG (The "Burn")
-- Serkan Usta her sabah Tulumba dÃ¶kÃ¼yor, Emre ise haftada iki dondurma yapÄ±yor.
INSERT INTO ktd_production_log (branch_id, product_id, batch_quantity, status, timestamp) VALUES 
(1, 1, 15.0, 'COMPLETED', '2025-10-01 07:30:00'), -- Serkan: 15kg Tulumba
(1, 2, 20.0, 'COMPLETED', '2025-10-01 10:00:00'), -- Emre: 20kg MaraÅŸ Dondurma
(1, 1, 12.0, 'COMPLETED', '2025-10-02 07:45:00'), -- Serkan: 12kg Tulumba
(1, 1, 18.0, 'COMPLETED', '2025-10-03 07:15:00'), -- Serkan: 18kg Tulumba (Hafta sonu hazÄ±rlÄ±ÄŸÄ±)
(1, 2, 40.0, 'COMPLETED', '2025-10-04 09:00:00'); -- Emre: 40kg Dondurma (YoÄŸun Cumartesi)

-- 2. RETAIL SALES (The "Heartbeat")
-- GÃ¼nlÃ¼k kÃ¼Ã§Ã¼k satÄ±ÅŸlar. AI'nÄ±n akÅŸam yoÄŸunluÄŸunu gÃ¶rmesi iÃ§in saatlere dikkat!
INSERT INTO ktd_sales_log (branch_id, product_id, quantity_sold, total_price, timestamp) VALUES 
(1, 1, 1.5, 300.00, '2025-10-01 12:30:00'),
(1, 2, 0.5, 100.00, '2025-10-01 19:45:00'), -- AkÅŸam dondurma keyfi
(1, 2, 2.0, 400.00, '2025-10-01 20:15:00'), 
(1, 1, 3.0, 600.00, '2025-10-04 15:00:00'), -- Cumartesi Tulumba yoÄŸunluÄŸu
(1, 2, 5.5, 1100.00, '2025-10-04 21:30:00'); -- Cumartesi akÅŸam dondurma kuyruÄŸu

-- 3. B2B / WHOLESALE (Hilton Otel Ekim SipariÅŸi)
INSERT INTO ktd_sales_log (branch_id, product_id, quantity_sold, total_price, customer_id, timestamp) VALUES 
(1, 2, 50.0, 10000.00, 1, '2025-10-05 09:00:00'); -- Hilton'a 50kg Dondurma

-- 4. AUTOMATED INVOICE (Hilton iÃ§in fatura)
INSERT INTO ktd_invoices (customer_id, sale_id, amount, invoice_date, is_paid) VALUES 
(1, LAST_INSERT_ID(), 10000.00, '2025-10-05', 0);


-- 1. YENÄ° ÃœRETÄ°M: FATMA HANIMIN KIÅžLIKLARI & BAKLAVA
INSERT INTO ktd_production_log (branch_id, product_id, batch_quantity, status, timestamp) VALUES 
(1, 1, 20.0, 'COMPLETED', '2025-10-20 08:00:00'), -- Serkan: 20kg Tulumba
(1, 3, 10.0, 'COMPLETED', '2025-10-22 09:30:00'), -- Fatma: 10 Tepsi Baklava
(1, 2, 10.0, 'COMPLETED', '2025-10-25 11:00:00'); -- Emre: Sezonun son bÃ¼yÃ¼k dondurma grubu

-- 2. FISTIK FÄ°YAT KRÄ°ZÄ° (1 KasÄ±m 2025)
-- AI bu deÄŸiÅŸikliÄŸi 'current_cost' Ã¼zerinden takip edecek.
UPDATE ktd_ingredients SET current_cost = 1350.00 WHERE ingredient_name LIKE '%FÄ±stÄ±k%';

-- 3. KRÄ°Z SONRASI MALZEME ALIMI
-- Fiyatlar yÃ¼kselmesine raÄŸmen Fatma hanÄ±m baklava iÃ§in malzeme alÄ±yor.
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 1, 50.0, 'PURCHASE', 'Fiyat artÄ±ÅŸÄ±na raÄŸmen stok takviyesi yapÄ±ldÄ± - TedarikÃ§i: Gaziantep'),
(1, 3, 500.0, 'PURCHASE', 'Un stoku gÃ¼ncellendi');

-- 4. KASIM AYI SATIÅžLARI (HavanÄ±n soÄŸumasÄ±yla dondurma dÃ¼ÅŸÃ¼yor, baklava artÄ±yor)
INSERT INTO ktd_sales_log (branch_id, product_id, quantity_sold, total_price, timestamp) VALUES 
(1, 3, 2.0, 1500.00, '2025-11-05 14:00:00'), -- Baklava satÄ±ÅŸÄ±
(1, 1, 5.0, 1000.00, '2025-11-05 16:30:00'), -- Tulumba satÄ±ÅŸÄ±
(1, 2, 0.5, 100.00, '2025-11-05 18:00:00'); -- Dondurma (azalan talep)

-- 5. AI DÃœZELTMESÄ° (Ã–rnek AI MÃ¼dahalesi)
-- AI, Serkan ustanÄ±n kaydetmeyi unuttuÄŸu bir zayiatÄ± tespit ediyor.
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 4, -5.0, 'AI_ADJUSTMENT', 'SÃ¼t kullanÄ±m verilerindeki sapma nedeniyle AI tarafÄ±ndan otomatik stok dÃ¼zeltmesi yapÄ±ldÄ±.');



-- CHUNK 4: DECEMBER FINALE & YEAR-END BILLING

-- 1. ARALIK AYI ÃœRETÄ°M PATLAMASI (YÄ±lbaÅŸÄ± SipariÅŸleri)
INSERT INTO ktd_production_log (branch_id, product_id, batch_quantity, status, timestamp) VALUES 
(1, 3, 50.0, 'COMPLETED', '2025-12-20 06:00:00'), -- Fatma: 50 Tepsi YÄ±lbaÅŸÄ± BaklavasÄ±
(1, 1, 40.0, 'COMPLETED', '2025-12-28 07:00:00'), -- Serkan: 40kg Bayram TulumbasÄ±
(1, 3, 30.0, 'WASTED', '2025-12-29 14:00:00');    -- ZAYÄ°AT: FÄ±rÄ±n arÄ±zasÄ± nedeniyle 30 tepsi yandÄ±!

-- 2. ZAYÄ°ATIN STOKTAN DÃœÅžÃœLMESÄ°
-- AI bu 'WASTED' durumunu gÃ¶rÃ¼nce malzemeleri otomatik olarak 'WASTE' nedeni ile deftere iÅŸler.
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 1, -9.0, 'WASTE', 'FÄ±rÄ±n arÄ±zasÄ± kaynaklÄ± yanma - Ãœretim ID: 8'),
(1, 3, -15.0, 'WASTE', 'FÄ±rÄ±n arÄ±zasÄ± kaynaklÄ± yanma - Ãœretim ID: 8');

-- 3. BÃœYÃœK TAHSÄ°LATLAR (Hilton ve Kordon Kafe Ã–demeleri)
INSERT INTO ktd_payments (customer_id, amount_paid, payment_date, payment_method) VALUES 
(1, 7700.00, '2025-12-15', 'TRANSFER'), -- Hilton geÃ§miÅŸ borcunu kapattÄ±
(2, 1500.00, '2025-12-20', 'CARD');     -- Kordon Kafe Ã¶demesi

-- 4. YILSONU PERAKENDE SATIÅžLARI (Zirve NoktasÄ±)
INSERT INTO ktd_sales_log (branch_id, product_id, quantity_sold, total_price, timestamp) VALUES 
(1, 3, 10.0, 7500.00, '2025-12-31 18:00:00'), -- YÄ±lbaÅŸÄ± akÅŸamÄ± Baklava satÄ±ÅŸÄ±
(1, 1, 8.0, 1600.00, '2025-12-31 19:30:00');  -- YÄ±lbaÅŸÄ± akÅŸamÄ± Tulumba satÄ±ÅŸÄ±


-- 1. B2B DEBT RECONCILIATION
-- Let's check where the Hilton (Customer 1) stands after their $7,700 payment.
-- They had invoices of $4,500 and $3,200 (Total $7,700). 
-- Since they paid $7,700, their current balance should be $0. 
-- We will mark those invoices as PAID to clear the dashboard.
UPDATE ktd_invoices SET is_paid = 1 WHERE customer_id = 1 AND invoice_date < '2026-01-01';

-- 2. THE "CLEAN START" PURCHASE (Jan 5, 2026)
-- After the December rush, Serkan usta realizes the flour and sugar bins are nearly empty.
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 2, 800.0, 'PURCHASE', 'Post-holiday replenishment - Sugar'),
(1, 3, 1000.0, 'PURCHASE', 'Post-holiday replenishment - Flour');

-- 3. AI AUDIT: THE TULUMBA MYSTERY ðŸ©
-- The AI notices that the "AyÃ§iÃ§ek YaÄŸÄ±" (Oil) level is lower than expected 
-- based on the reported batches. It logs an adjustment.
INSERT INTO ktd_stock_ledger (branch_id, ingredient_id, quantity_change, reason, ai_context) VALUES 
(1, 5, -12.5, 'AI_ADJUSTMENT', 'Oil consumption discrepancy detected. Likely unlogged deep-fryer refresh.');

-- 4. NEW YEAR B2B OPENING SALE
-- Kordon Kafe (Customer 2) starts the year with a large order for a private event.
INSERT INTO ktd_sales_log (branch_id, product_id, quantity_sold, total_price, customer_id, timestamp) VALUES 
(1, 1, 25.0, 5000.00, 2, '2026-01-10 10:00:00');

INSERT INTO ktd_invoices (customer_id, sale_id, amount, invoice_date, is_paid) VALUES 
(2, LAST_INSERT_ID(), 5000.00, '2026-01-10', 0);
